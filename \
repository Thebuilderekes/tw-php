<?php
require "../Validator.php";
 require "../Database.php";
$heading = "note page";
$hostname = $_ENV['HOSTNAME2'];
$dbname = $_ENV['DBNAME2'];
$username = $_ENV['USERNAME2'];
$password = $_ENV['PASSWORD2'];
$notes_record = new Database($hostname, $dbname, $username, $password);

// $validator object is used from Validator class give a reusable method string check on any input that needs to be checked
$validator = new Validator();

//submit form input to users table
if(isset( $_POST['messages'])){
     $message = htmlspecialchars($_POST['message']);

     $validator = new Validator();
}
if($_SERVER['REQUEST_METHOD'] === "POST"){


    $sql = "INSERT INTO notes(id , body) VALUES (:id, :message)";

  if ($validator->string($_POST['message'])){

    $notesparams = [":id", ":body" => $message];
    $notes_record->query($sql, $notesparams);

    $error['form_error'] = "Your details have been submitted!";

  }else{
    $error['form_error'] = "Please fill out any empty field";
  }

}

$notes= $notes_record->fetchItems('select * FROM notes')->fetchAll(PDO::FETCH_ASSOC);
$check = "notes.php connection";

echo $check;
echo $sql;
require("../views/note.views.php");



